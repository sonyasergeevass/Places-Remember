{% load static %}
{% load socialaccount %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add memories</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
          rel="stylesheet">
    <script src="https://api-maps.yandex.ru/2.1/?apikey=914dd15d-8d71-4e65-9372-795958fae570&lang=ru_RU"
            type="text/javascript"></script>
    <link href="{% static 'app_pr/css/add_mem.css' %}" rel="stylesheet">
</head>
<body>
<div class="top-panel">
    <div class="row">
        <div class="col-md-6">
            <h3>Places Remember</h3>
        </div>
        <div class="col-md-6 text-md-end">
            <div class="user-info">
                <img src="{{ vk_data.photo_big }}">
                <span>{{ user.first_name }}</span>
                <a class="btn btn-primary" href="{% url 'logout' %}">Sign
                    out</a>
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="map-container">
        <div id="map"></div>
    </div>
    <div class="form-container">
        <form action="{% url 'add_mem' %}" method="POST">
            {% csrf_token %}
            <input id="latitude" name="latitude" required type="hidden" value="">
            <input id="longitude" name="longitude" required type="hidden" value="">
            <input name="title" placeholder="Name of the memory" required type="text">
            <textarea name="description" placeholder="Description of the memory"
                      required></textarea>
            <button type="submit">Save memory</button>
        </form>
    </div>
</div>
<script type="text/javascript">
    ymaps.ready(init);
    function init(){
        var myMap = new ymaps.Map("map", {
            center: [55.76, 37.64],
            zoom: 10
        });

        var placemark = null;

        myMap.events.add('click', function (e) {
            var coords = e.get('coords');
            if (placemark) {
                myMap.geoObjects.remove(placemark);
            }
            placemark = new ymaps.Placemark(coords);
            myMap.geoObjects.add(placemark);
            document.getElementById('latitude').value = coords[0];
            document.getElementById('longitude').value = coords[1];
        });
    }
</script>
</body>
</html>